<!-- Global Navigation Header Component -->
<nav class="global-nav" id="globalNav">
    <div class="nav-container">
        <div class="nav-brand">
            <a href="index.html" class="brand-link">
                <div class="brand-icon">
                    <i class="fas fa-cube"></i>
                </div>
                <span class="brand-text">SourceLess</span>
            </a>
            <div class="network-indicator">
                <div class="network-dot"></div>
                <span>Mainnet</span>
            </div>
        </div>

        <div class="nav-search">
            <div class="search-container">
                <i class="fas fa-search search-icon"></i>
                <input type="text" class="search-input" placeholder="Search blocks, txns, addresses, domains..." id="globalSearchInput">
                <kbd class="search-shortcut">Ctrl+K</kbd>
            </div>
        </div>

        <div class="nav-links">
            <a href="sourceless-explorer-subscan.html" class="nav-link">
                <i class="fas fa-search"></i>
                <span>Explorer</span>
            </a>
            <a href="magnet-wallet-pro.html" class="nav-link">
                <i class="fas fa-wallet"></i>
                <span>Wallet</span>
            </a>
            <a href="network-monitor-pro.html" class="nav-link">
                <i class="fas fa-network-wired"></i>
                <span>Network</span>
            </a>
            <a href="professional-dashboard.html" class="nav-link" data-auth="required">
                <i class="fas fa-tachometer-alt"></i>
                <span>Dashboard</span>
            </a>
        </div>

        <div class="nav-user">
            <div class="wallet-info" id="walletInfo" style="display: none;">
                <div class="wallet-balance">
                    <span class="balance-amount" id="navWalletBalance">0.00 STR</span>
                    <span class="balance-usd" id="navWalletUSD">$0.00</span>
                </div>
                <div class="wallet-address" id="navWalletAddress" onclick="Utils.copyToClipboard(this.textContent)">
                    No wallet connected
                </div>
            </div>

            <div class="user-menu">
                <button class="user-button" id="userMenuButton" onclick="toggleUserMenu()">
                    <i class="fas fa-user"></i>
                </button>
                <div class="user-dropdown" id="userDropdown">
                    <div data-auth="guest">
                        <a href="#" onclick="openLoginModal()" class="dropdown-item">
                            <i class="fas fa-sign-in-alt"></i>
                            <span>Login</span>
                        </a>
                    </div>
                    <div data-auth="required">
                        <div class="dropdown-header">
                            <div class="user-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="user-details">
                                <div class="user-name" id="navUserName">Administrator</div>
                                <div class="user-role" id="navUserRole">Super Admin</div>
                            </div>
                        </div>
                        <hr class="dropdown-divider">
                        <a href="#" class="dropdown-item">
                            <i class="fas fa-cog"></i>
                            <span>Settings</span>
                        </a>
                        <a href="#" class="dropdown-item">
                            <i class="fas fa-shield-alt"></i>
                            <span>Security</span>
                        </a>
                        <a href="#" onclick="SourceLess.auth.logout()" class="dropdown-item text-danger">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Logout</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</nav>

<!-- Global Search Modal -->
<div class="modal" id="globalSearchModal">
    <div class="modal-backdrop" onclick="closeGlobalSearch()"></div>
    <div class="modal-content search-modal">
        <div class="modal-header">
            <h3>Global Search</h3>
            <button class="close-btn" onclick="closeGlobalSearch()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body">
            <div class="search-input-container">
                <i class="fas fa-search"></i>
                <input type="text" id="globalSearchQuery" placeholder="Search anything on SourceLess..." autofocus>
            </div>
            <div class="search-suggestions">
                <div class="suggestion-category">
                    <div class="category-title">Recent Searches</div>
                    <div class="suggestions-list" id="recentSearches"></div>
                </div>
                <div class="suggestion-category">
                    <div class="category-title">Quick Actions</div>
                    <div class="suggestions-list">
                        <a href="magnet-wallet-pro.html" class="suggestion-item">
                            <i class="fas fa-wallet"></i>
                            <span>Open Wallet</span>
                        </a>
                        <a href="network-monitor-pro.html" class="suggestion-item">
                            <i class="fas fa-chart-line"></i>
                            <span>Network Status</span>
                        </a>
                        <a href="professional-dashboard.html" class="suggestion-item">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>Admin Panel</span>
                        </a>
                    </div>
                </div>
            </div>
            <div class="search-results" id="globalSearchResults" style="display: none;">
                <div class="results-category">
                    <div class="category-title">Blocks</div>
                    <div class="results-list" id="blockResults"></div>
                </div>
                <div class="results-category">
                    <div class="category-title">Transactions</div>
                    <div class="results-list" id="transactionResults"></div>
                </div>
                <div class="results-category">
                    <div class="category-title">Addresses</div>
                    <div class="results-list" id="addressResults"></div>
                </div>
                <div class="results-category">
                    <div class="category-title">Domains</div>
                    <div class="results-list" id="domainResults"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Login Modal -->
<div class="modal" id="loginModal">
    <div class="modal-backdrop" onclick="closeLoginModal()"></div>
    <div class="modal-content login-modal">
        <div class="modal-header">
            <h3>Login to SourceLess</h3>
            <button class="close-btn" onclick="closeLoginModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body">
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label for="loginUsername">Username</label>
                    <input type="text" id="loginUsername" name="username" required placeholder="Enter your username">
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <div class="password-input">
                        <input type="password" id="loginPassword" name="password" required placeholder="Enter your password">
                        <button type="button" class="password-toggle" onclick="togglePasswordVisibility('loginPassword')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="remember">
                        <span class="checkmark"></span>
                        Remember me
                    </label>
                </div>
                <button type="submit" class="btn btn-primary btn-block" id="loginSubmit">
                    <i class="fas fa-sign-in-alt"></i>
                    Login
                </button>
            </form>
            <div class="login-footer">
                <p><strong>Demo Credentials:</strong></p>
                <p>Username: <code>admin</code> | Password: <code>admin</code></p>
            </div>
        </div>
    </div>
</div>

<!-- Network Status Bar -->
<div class="network-status-bar" id="networkStatusBar">
    <div class="status-container">
        <div class="status-item">
            <div class="status-indicator healthy" id="networkStatusIndicator"></div>
            <span class="status-text" id="networkStatusText">Network Healthy</span>
        </div>
        <div class="status-item">
            <i class="fas fa-cube"></i>
            <span>Block <span id="statusBarBlock">6,006,234</span></span>
        </div>
        <div class="status-item">
            <i class="fas fa-tachometer-alt"></i>
            <span><span id="statusBarTPS">4,231</span> TPS</span>
        </div>
        <div class="status-item">
            <i class="fas fa-coins"></i>
            <span>STR $<span id="statusBarPrice">17.42</span></span>
        </div>
    </div>
</div>

<style>
/* Global Navigation Styles */
.global-nav {
    background: #ffffff;
    border-bottom: 1px solid #e2e8f0;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    position: sticky;
    top: 0;
    z-index: 1000;
    height: 64px;
}

.nav-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 24px;
    height: 100%;
    display: flex;
    align-items: center;
    gap: 24px;
}

.nav-brand {
    display: flex;
    align-items: center;
    gap: 16px;
}

.brand-link {
    display: flex;
    align-items: center;
    gap: 12px;
    text-decoration: none;
    color: #0066ff;
    font-weight: 700;
    font-size: 20px;
}

.brand-icon {
    width: 32px;
    height: 32px;
    background: linear-gradient(135deg, #0066ff, #00d4ff);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
}

.network-indicator {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 4px 12px;
    background: #0066ff;
    color: white;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
}

.network-dot {
    width: 6px;
    height: 6px;
    background: #00ff88;
    border-radius: 50%;
    animation: pulse 2s infinite;
}

.nav-search {
    flex: 1;
    max-width: 500px;
}

.search-container {
    position: relative;
}

.search-input {
    width: 100%;
    height: 40px;
    padding: 0 100px 0 48px;
    border: 1px solid #e2e8f0;
    border-radius: 20px;
    font-size: 14px;
    background: #f8fafc;
    transition: all 0.2s ease;
}

.search-input:focus {
    outline: none;
    border-color: #0066ff;
    background: white;
    box-shadow: 0 0 0 3px rgba(0, 102, 255, 0.1);
}

.search-icon {
    position: absolute;
    left: 16px;
    top: 50%;
    transform: translateY(-50%);
    color: #64748b;
}

.search-shortcut {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    background: #e2e8f0;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 11px;
    color: #64748b;
}

.nav-links {
    display: flex;
    gap: 8px;
}

.nav-link {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 16px;
    border-radius: 8px;
    text-decoration: none;
    color: #64748b;
    font-weight: 500;
    transition: all 0.2s ease;
}

.nav-link:hover {
    background: #f1f5f9;
    color: #0066ff;
}

.nav-link.active {
    background: #eff6ff;
    color: #0066ff;
}

.nav-user {
    display: flex;
    align-items: center;
    gap: 16px;
}

.wallet-info {
    text-align: right;
}

.balance-amount {
    font-weight: 600;
    color: #1a202c;
}

.balance-usd {
    font-size: 12px;
    color: #64748b;
}

.wallet-address {
    font-family: 'Monaco', monospace;
    font-size: 11px;
    color: #0066ff;
    cursor: pointer;
    padding: 2px 8px;
    background: #eff6ff;
    border-radius: 12px;
    margin-top: 2px;
}

.user-menu {
    position: relative;
}

.user-button {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border: 1px solid #e2e8f0;
    background: #f8fafc;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
}

.user-button:hover {
    background: #0066ff;
    color: white;
}

.user-dropdown {
    position: absolute;
    top: 100%;
    right: 0;
    margin-top: 8px;
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
    min-width: 200px;
    display: none;
}

.user-dropdown.show {
    display: block;
}

.dropdown-header {
    padding: 16px;
    display: flex;
    align-items: center;
    gap: 12px;
}

.user-avatar {
    width: 32px;
    height: 32px;
    background: #0066ff;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
}

.user-name {
    font-weight: 600;
    color: #1a202c;
}

.user-role {
    font-size: 12px;
    color: #64748b;
}

.dropdown-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    text-decoration: none;
    color: #374151;
    transition: all 0.2s ease;
}

.dropdown-item:hover {
    background: #f9fafb;
}

.dropdown-divider {
    margin: 8px 0;
    border: none;
    border-top: 1px solid #e5e7eb;
}

.text-danger {
    color: #dc2626 !important;
}

/* Network Status Bar */
.network-status-bar {
    background: linear-gradient(135deg, #0066ff, #00d4ff);
    color: white;
    padding: 8px 0;
    font-size: 12px;
}

.status-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 24px;
    display: flex;
    align-items: center;
    gap: 24px;
}

.status-item {
    display: flex;
    align-items: center;
    gap: 6px;
}

.status-indicator {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    animation: pulse 2s infinite;
}

.status-indicator.healthy {
    background: #00ff88;
}

.status-indicator.warning {
    background: #ffaa00;
}

.status-indicator.critical {
    background: #ff4444;
}

/* Modals */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 2000;
}

.modal.show {
    display: flex;
}

.modal-backdrop {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.modal-content {
    background: white;
    border-radius: 12px;
    max-width: 500px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    position: relative;
    z-index: 1;
}

.modal-header {
    padding: 24px 24px 16px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 1px solid #e5e7eb;
}

.modal-header h3 {
    margin: 0;
    font-size: 18px;
    font-weight: 600;
    color: #1a202c;
}

.close-btn {
    width: 32px;
    height: 32px;
    border: none;
    background: #f3f4f6;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: #6b7280;
}

.close-btn:hover {
    background: #e5e7eb;
}

.modal-body {
    padding: 24px;
}

/* Search Modal Specific */
.search-modal {
    max-width: 600px;
}

.search-input-container {
    position: relative;
    margin-bottom: 24px;
}

.search-input-container input {
    width: 100%;
    height: 48px;
    padding: 0 48px;
    border: 2px solid #e5e7eb;
    border-radius: 8px;
    font-size: 16px;
}

.search-input-container i {
    position: absolute;
    left: 16px;
    top: 50%;
    transform: translateY(-50%);
    color: #9ca3af;
}

.suggestion-category,
.results-category {
    margin-bottom: 24px;
}

.category-title {
    font-size: 14px;
    font-weight: 600;
    color: #374151;
    margin-bottom: 12px;
}

.suggestion-item,
.result-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    border-radius: 6px;
    text-decoration: none;
    color: #374151;
    transition: all 0.2s ease;
}

.suggestion-item:hover,
.result-item:hover {
    background: #f3f4f6;
}

/* Form Styles */
.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 6px;
    font-weight: 500;
    color: #374151;
}

.form-group input {
    width: 100%;
    height: 44px;
    padding: 0 12px;
    border: 1px solid #d1d5db;
    border-radius: 6px;
    font-size: 14px;
    transition: all 0.2s ease;
}

.form-group input:focus {
    outline: none;
    border-color: #0066ff;
    box-shadow: 0 0 0 3px rgba(0, 102, 255, 0.1);
}

.password-input {
    position: relative;
}

.password-toggle {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    color: #9ca3af;
    cursor: pointer;
}

.checkbox-label {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
}

.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 12px 24px;
    border: none;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    text-decoration: none;
}

.btn-primary {
    background: #0066ff;
    color: white;
}

.btn-primary:hover {
    background: #0052cc;
}

.btn-block {
    width: 100%;
}

.login-footer {
    margin-top: 24px;
    padding-top: 16px;
    border-top: 1px solid #e5e7eb;
    text-align: center;
    font-size: 13px;
    color: #6b7280;
}

.login-footer code {
    background: #f3f4f6;
    padding: 2px 6px;
    border-radius: 4px;
    font-family: 'Monaco', monospace;
}

/* Responsive */
@media (max-width: 768px) {
    .nav-container {
        padding: 0 16px;
        gap: 12px;
    }

    .nav-search {
        order: 3;
        flex-basis: 100%;
    }

    .nav-links {
        display: none;
    }

    .status-container {
        padding: 0 16px;
        gap: 12px;
        flex-wrap: wrap;
    }

    .modal-content {
        margin: 16px;
        width: calc(100% - 32px);
    }
}

@keyframes pulse {
    0%, 100% {
        opacity: 1;
        transform: scale(1);
    }
    50% {
        opacity: 0.7;
        transform: scale(1.1);
    }
}
</style>

<script>
// Global Navigation JavaScript
function toggleUserMenu() {
    const dropdown = document.getElementById('userDropdown');
    dropdown.classList.toggle('show');
}

function openLoginModal() {
    document.getElementById('loginModal').classList.add('show');
    closeUserMenu();
}

function closeLoginModal() {
    document.getElementById('loginModal').classList.remove('show');
}

function closeUserMenu() {
    document.getElementById('userDropdown').classList.remove('show');
}

function openGlobalSearch() {
    document.getElementById('globalSearchModal').classList.add('show');
    document.getElementById('globalSearchQuery').focus();
}

function closeGlobalSearch() {
    document.getElementById('globalSearchModal').classList.remove('show');
}

function togglePasswordVisibility(inputId) {
    const input = document.getElementById(inputId);
    const toggle = input.parentElement.querySelector('.password-toggle i');
    
    if (input.type === 'password') {
        input.type = 'text';
        toggle.className = 'fas fa-eye-slash';
    } else {
        input.type = 'password';
        toggle.className = 'fas fa-eye';
    }
}

async function handleLogin(event) {
    event.preventDefault();
    
    const submitButton = document.getElementById('loginSubmit');
    const form = event.target;
    const formData = new FormData(form);
    
    const credentials = {
        username: formData.get('username'),
        password: formData.get('password')
    };
    
    // Show loading state
    submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Logging in...';
    submitButton.disabled = true;
    
    try {
        const result = await SourceLess.auth.login(credentials);
        
        if (result.success) {
            Utils.showToast('Login successful!', 'success');
            closeLoginModal();
            updateNavigationForUser(result.user);
        } else {
            Utils.showToast(result.error || 'Login failed', 'error');
        }
    } catch (error) {
        Utils.showToast('Login error occurred', 'error');
    } finally {
        submitButton.innerHTML = '<i class="fas fa-sign-in-alt"></i> Login';
        submitButton.disabled = false;
    }
}

function updateNavigationForUser(user) {
    // Update user info in navigation
    document.getElementById('navUserName').textContent = user.username;
    document.getElementById('navUserRole').textContent = user.role || 'User';
    
    // Update auth-dependent elements
    SourceLess.auth.updateAuthUI();
}

// Global search functionality
let searchTimeout;
document.addEventListener('DOMContentLoaded', () => {
    const globalSearchInput = document.getElementById('globalSearchQuery');
    const searchResults = document.getElementById('globalSearchResults');
    
    if (globalSearchInput) {
        globalSearchInput.addEventListener('input', (e) => {
            clearTimeout(searchTimeout);
            const query = e.target.value.trim();
            
            if (query.length > 2) {
                searchTimeout = setTimeout(async () => {
                    await performGlobalSearch(query);
                }, 300);
            } else {
                searchResults.style.display = 'none';
            }
        });
        
        globalSearchInput.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeGlobalSearch();
            }
        });
    }
});

async function performGlobalSearch(query) {
    const searchResults = document.getElementById('globalSearchResults');
    const suggestions = document.querySelector('.search-suggestions');
    
    try {
        const results = await SourceLess.blockchain.searchBlockchain(query);
        
        // Hide suggestions, show results
        suggestions.style.display = 'none';
        searchResults.style.display = 'block';
        
        // Populate results
        populateSearchResults('blockResults', results.blocks, 'block');
        populateSearchResults('transactionResults', results.transactions, 'transaction');
        populateSearchResults('addressResults', results.addresses, 'address');
        populateSearchResults('domainResults', results.domains, 'domain');
        
        // Save to recent searches
        saveRecentSearch(query);
        
    } catch (error) {
        console.error('Search error:', error);
        Utils.showToast('Search failed', 'error');
    }
}

function populateSearchResults(containerId, results, type) {
    const container = document.getElementById(containerId);
    if (!container || !results.length) {
        container.innerHTML = '<div class="no-results">No results found</div>';
        return;
    }
    
    container.innerHTML = results.map(result => {
        let content = '';
        switch (type) {
            case 'block':
                content = `
                    <div class="result-item" onclick="viewBlock(${result.number})">
                        <i class="fas fa-cube"></i>
                        <div>
                            <div>Block #${result.number}</div>
                            <div style="font-size: 12px; color: #6b7280;">${result.transactions} transactions</div>
                        </div>
                    </div>
                `;
                break;
            case 'transaction':
                content = `
                    <div class="result-item" onclick="viewTransaction('${result.hash}')">
                        <i class="fas fa-exchange-alt"></i>
                        <div>
                            <div>${Utils.formatAddress(result.hash)}</div>
                            <div style="font-size: 12px; color: #6b7280;">${result.method} â€¢ ${result.value}</div>
                        </div>
                    </div>
                `;
                break;
            case 'address':
                content = `
                    <div class="result-item" onclick="viewAddress('${result.address}')">
                        <i class="fas fa-user"></i>
                        <div>
                            <div>${Utils.formatAddress(result.address)}</div>
                            <div style="font-size: 12px; color: #6b7280;">Balance: ${result.balance}</div>
                        </div>
                    </div>
                `;
                break;
            case 'domain':
                content = `
                    <div class="result-item" onclick="viewDomain('${result.domain}')">
                        <i class="fas fa-globe"></i>
                        <div>
                            <div>${result.domain}</div>
                            <div style="font-size: 12px; color: #6b7280;">Value: ${result.value}</div>
                        </div>
                    </div>
                `;
                break;
        }
        return content;
    }).join('');
}

function saveRecentSearch(query) {
    const recent = JSON.parse(localStorage.getItem('sourceless-recent-searches') || '[]');
    const filtered = recent.filter(item => item !== query);
    filtered.unshift(query);
    
    // Keep only last 5 searches
    const updated = filtered.slice(0, 5);
    localStorage.setItem('sourceless-recent-searches', JSON.stringify(updated));
    
    updateRecentSearches();
}

function updateRecentSearches() {
    const container = document.getElementById('recentSearches');
    if (!container) return;
    
    const recent = JSON.parse(localStorage.getItem('sourceless-recent-searches') || '[]');
    
    if (recent.length === 0) {
        container.innerHTML = '<div style="color: #9ca3af; font-size: 12px;">No recent searches</div>';
        return;
    }
    
    container.innerHTML = recent.map(query => `
        <div class="suggestion-item" onclick="searchQuery('${query}')">
            <i class="fas fa-clock"></i>
            <span>${query}</span>
        </div>
    `).join('');
}

function searchQuery(query) {
    document.getElementById('globalSearchQuery').value = query;
    performGlobalSearch(query);
}

// Navigation helper functions
function viewBlock(blockNumber) {
    closeGlobalSearch();
    Utils.showToast(`Viewing block #${blockNumber}`, 'info');
    // In production: navigate to block detail page
}

function viewTransaction(hash) {
    closeGlobalSearch();
    Utils.showToast(`Viewing transaction ${Utils.formatAddress(hash)}`, 'info');
    // In production: navigate to transaction detail page
}

function viewAddress(address) {
    closeGlobalSearch();
    Utils.showToast(`Viewing address ${Utils.formatAddress(address)}`, 'info');
    // In production: navigate to address detail page
}

function viewDomain(domain) {
    closeGlobalSearch();
    Utils.showToast(`Viewing domain ${domain}`, 'info');
    // In production: navigate to domain detail page
}

// Close dropdowns when clicking outside
document.addEventListener('click', (e) => {
    if (!e.target.closest('.user-menu')) {
        closeUserMenu();
    }
});

// Initialize navigation
document.addEventListener('DOMContentLoaded', () => {
    // Update recent searches
    updateRecentSearches();
    
    // Set active navigation link
    const currentPage = window.location.pathname.split('/').pop();
    document.querySelectorAll('.nav-link').forEach(link => {
        if (link.getAttribute('href') === currentPage) {
            link.classList.add('active');
        }
    });
    
    // Update authentication UI
    if (window.SourceLess && window.SourceLess.auth) {
        SourceLess.auth.updateAuthUI();
        
        // Update user info if logged in
        if (SourceLess.auth.isAuthenticated()) {
            updateNavigationForUser(SourceLess.auth.currentUser);
        }
    }
});

// Update network status in navigation
async function updateNavigationStatus() {
    if (window.SourceLess) {
        try {
            const stats = await SourceLess.blockchain.getNetworkStats();
            const status = await SourceLess.network.getStatus();
            
            // Update status bar
            const elements = {
                statusBarBlock: stats.latestBlock,
                statusBarTPS: stats.tps,
                statusBarPrice: '17.42'
            };
            
            Object.entries(elements).forEach(([id, value]) => {
                const element = document.getElementById(id);
                if (element) {
                    if (typeof value === 'number') {
                        element.textContent = value.toLocaleString();
                    } else {
                        element.textContent = value;
                    }
                }
            });
            
            // Update status indicator
            const indicator = document.getElementById('networkStatusIndicator');
            const text = document.getElementById('networkStatusText');
            if (indicator && text) {
                indicator.className = `status-indicator ${status.health}`;
                text.textContent = status.message;
            }
            
        } catch (error) {
            console.error('Failed to update navigation status:', error);
        }
    }
}

// Update status every 30 seconds
setInterval(updateNavigationStatus, 30000);

// Initial status update
setTimeout(updateNavigationStatus, 1000);
</script>